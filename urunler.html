<!DOCTYPE html>
<html>

<head>

    <title>Muhasebe</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">



</head>

<body>

<div class="w3-container w3-blue w3-card">
    <h1>ARI PLASTİK MUHASEBE</h1>
</div>

<div class="tab">

    <form class="form">
        <p class="x1">
            <label>Ürün: </label>
            <select id="urun">
                <option value="Muz">Muz</option>
                <option value="Çilek">Çilek</option>
                <option value="M.Çilek">M.Çilek</option>
            </select>
        <p class="x7">
            <label style="padding-right: 15px">ID: </label>
            <input class="w3-input" id="ID" type="text">
        </p>
        <p class="x2">
            <label>Adet: </label>
            <input class="w3-input" type="text" id="adet"></p>
        <p class="x3">
            <label>Fiyat: </label>
            <input class="w3-input" type="text" id="fiyat"></p>
        <p class="x4">
            <label>Alıcı: </label>
            <input class="w3-input" type="text" id="alici"></p>
        <p class="x6">
            <label>Tarih: </label>
            <input class="w3-input" id="tarih" type="text" placeholder="dd/mm/yyyy" required>
        </p>
        <P class="x5">
            <button type="button" class="w3-btn w3-blue" id="save">Kaydet</button>

    </form>
    <br>

</div>

<div class="container mt-3">
    <table class="table table-dark">
        <thead>

        <th>ID</th>
        <th>Ürün</th>
        <th>Adet</th>
        <th>Fiyat</th>
        <th>Alici</th>
        <th>Ücret</th>
        <th>Tarih</th>

        </thead>

        <tbody id="tbody1"></tbody>

    </table>
</div>

<script type="module">

    var idd = 0;
    var tbody = document.getElementById('tbody1');

    function AddItemToTable(urrun,addet,fiyyat,allici,uccret,tarrih){

        let trow = document.createElement('tr');
        let td1 = document.createElement('td');
        let td2 = document.createElement('td');
        let td3 = document.createElement('td');
        let td4 = document.createElement('td');
        let td5 = document.createElement('td');
        let td6 = document.createElement('td');
        let td7 = document.createElement('td');

        td1.innerHTML = ++idd;
        td2.innerHTML = urrun;
        td3.innerHTML = addet;
        td4.innerHTML = fiyyat;
        td5.innerHTML = allici;
        td6.innerHTML = uccret;
        td7.innerHTML = tarrih;

        trow.appendChild(td1);
        trow.appendChild(td2);
        trow.appendChild(td3);
        trow.appendChild(td4);
        trow.appendChild(td5);
        trow.appendChild(td6);
        trow.appendChild(td7);

        tbody.appendChild(trow);
    }

    function AddAllItemsToTable(TheStudent){
        idd=0;
        tbody.innerHTML="";
        TheStudent.forEach(element => {

            AddItemToTable(element.Urun, element.Adet, element.Fiyat, element.Alici, element.Ucret, element.Tarih);

        });
    }

    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.4/firebase-app.js";
    const firebaseConfig = {
        apiKey: "AIzaSyC2W0ZQNDQbcJrhi9jkOQC4h-ZqAKn1hWc",
        authDomain: "muhasebe-8abea.firebaseapp.com",
        databaseURL: "https://muhasebe-8abea-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "muhasebe-8abea",
        storageBucket: "muhasebe-8abea.appspot.com",
        messagingSenderId: "321395305665",
        appId: "1:321395305665:web:7d5d494000646bea52f840"
    };

    const app = initializeApp(firebaseConfig);


    import {getDatabase, ref, child, onValue, get}
        from "https://www.gstatic.com/firebasejs/9.8.4/firebase-database.js";

    const db = getDatabase();

    function GetAllDataOnce(){
        const dbRef = ref(db);

        get(child(dbRef, "StudentsList" ))
            .then((snapshot)=>{

                var students =[];

                snapshot.forEach(childSnapshot => {
                    students.push(childSnapshot.val());
                });

                AddAllItemsToTable(students);

            });
    }

    window.onload=GetAllDataOnce;

</script>

<script type="text/javascript">
    $('#save').on('click', function () {
        var urun = $('#urun').val();
        var ID = $('#ID').val();
        var tarih = $('#tarih').val();
        var adet = $('#adet').val();
        var fiyat = $('#fiyat').val();
        var alici = $('#alici').val();
        var ucret = $('#ucret').val();


        if (urun != "" && ID != "" && tarih != "" && adet != "" && fiyat != "" && alici != "") {
            $('#del tbody').append('<tr class="child"><td>' + ID + '</td><td>' + urun + '</td><td>' + tarih + '</td><td>' + adet + '</td><td>' + fiyat + "₺" + '</td><td>' + alici + '</td><td>' + adet * fiyat + "₺" + '</td><td><a id="del" style="color: white" class="remCF1 btn btn-small btn-danger">Sil</a></td></tr>');
        }
    });
    $(document).on('click', '.remCF1', function () {
        $(this).parent().parent().remove();
        $('#del tbody tr').each(function (i) {
            $($(this).find('td')[0]).html(i + 1);
        });
    });
</script>

<script type="module">

    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.4/firebase-app.js";


    const firebaseConfig = {
        apiKey: "AIzaSyC2W0ZQNDQbcJrhi9jkOQC4h-ZqAKn1hWc",
        authDomain: "muhasebe-8abea.firebaseapp.com",
        databaseURL: "https://muhasebe-8abea-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "muhasebe-8abea",
        storageBucket: "muhasebe-8abea.appspot.com",
        messagingSenderId: "321395305665",
        appId: "1:321395305665:web:7d5d494000646bea52f840"
    };

    const app = initializeApp(firebaseConfig);

    import {getDatabase, ref, get, set, child, update, remove}
        from "https://www.gstatic.com/firebasejs/9.8.4/firebase-database.js";

    const db = getDatabase();

    var ID1=document.getElementById("ID");
    var Tarih1=document.getElementById("tarih");
    var Urun1=document.getElementById("urun");
    var Adet1=document.getElementById("adet");
    var Fiyat1=document.getElementById("fiyat");
    var Alici1=document.getElementById("alici");




    var insBtn = document.getElementById("save");
    var selBtn = document.getElementById("SelBtn");
    var upBtn = document.getElementById("UpBtn");
    var delBtn = document.getElementById("del");

    function InsertData(){
        set(ref(db,"StudentsList/"+ID1.value),{

            ID: ID1.value,
            Tarih: Tarih1.value,
            Urun: Urun1.value,
            Adet: Adet1.value,
            Fiyat: Fiyat1.value,
            Alici: Alici1.value,


        })
            .then(()=>{
                alert("successfully");
            })
            .catch((error)=>{
                alert("alert"+error);
            });
    }

    insBtn.addEventListener('click',InsertData);

    function DeleteData(){
        remove(ref(db, "StudentsList/"+ID1.value))
            .then(()=>{
                alert("deleted");
            })
            .catch((error)=>{

                alert("error"+error);
            });
    }

    delBtn.addEventListener('click',DeleteData);

</script>


</body>



</html>
